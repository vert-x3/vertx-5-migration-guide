<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<title>Migrate from Vert.x 4 to 5</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Migrate from Vert.x 4 to 5</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_about_vert_x">About Vert.x</a></li>
<li><a href="#_whats_changed_in_vert_x_5">What&#8217;s changed in Vert.x 5</a></li>
<li><a href="#_handling_deprecations_and_removals">Handling deprecations and removals</a></li>
<li><a href="#_components_sunsets_and_removals">Components sunsets and removals</a></li>
<li><a href="#_embracing_the_future_model">Embracing the future model</a></li>
<li><a href="#_vert_x_builders">Vert.x builders</a></li>
<li><a href="#_changes_in_components">Changes in components</a></li>
<li><a href="#_vert_x_command_line_tool_removal">Vert.x command-line tool removal</a></li>
<li><a href="#_cli_framework_deprecation">CLI framework deprecation</a>
<ul class="sectlevel2">
<li><a href="#_vert_x_legacy_cli">Vert.x Legacy CLI</a></li>
<li><a href="#_vert_x_application_launcher">Vert.x Application Launcher</a></li>
</ul>
</li>
<li><a href="#_vert_x_core">Vert.x Core</a>
<ul class="sectlevel2">
<li><a href="#_vert_x_instance_customization">Vert.x instance customization</a></li>
<li><a href="#_http_related_changes">HTTP related changes</a></li>
<li><a href="#_future">Future</a></li>
<li><a href="#_logging">Logging</a></li>
<li><a href="#_system_properties">System properties</a></li>
<li><a href="#_worker_verticles">Worker verticles</a></li>
<li><a href="#_miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li><a href="#_vert_x_auth">Vert.x Auth</a>
<ul class="sectlevel2">
<li><a href="#_authprovider_pruning">AuthProvider pruning</a></li>
</ul>
</li>
<li><a href="#_vert_x_for_kotlin">Vert.x for Kotlin</a>
<ul class="sectlevel2">
<li><a href="#_removal_of_await_extension_methods_generation">Removal of await extension methods generation</a></li>
</ul>
</li>
<li><a href="#_vert_x_grpc">Vert.x gRPC</a>
<ul class="sectlevel2">
<li><a href="#_removal_of_grpcreadstreamcollecting_in_favour_of_readstreamcollect">Removal of GrpcReadStream#collecting in favour of ReadStream#collect</a></li>
<li><a href="#_removal_of_methods_declaring_a_method_descriptor">Removal of methods declaring a method descriptor</a></li>
</ul>
</li>
<li><a href="#_vert_x_web">Vert.x Web</a>
<ul class="sectlevel2">
<li><a href="#_routingcontext_user_api">RoutingContext user API</a></li>
<li><a href="#_static_handler_configuration">Static handler configuration</a></li>
</ul>
</li>
<li><a href="#_vert_x_web_client">Vert.x Web Client</a>
<ul class="sectlevel2">
<li><a href="#_response_expectation_replacement">Response expectation replacement</a></li>
</ul>
</li>
<li><a href="#_vert_x_web_graphql">Vert.x Web GraphQL</a>
<ul class="sectlevel2">
<li><a href="#_upgrade_to_graphql_java_22">Upgrade to GraphQL-Java 22</a></li>
</ul>
</li>
<li><a href="#_vert_x_web_validation">Vert.x Web Validation</a>
<ul class="sectlevel2">
<li><a href="#_replacement_of_deprecated_schemaparser">Replacement of deprecated SchemaParser</a></li>
</ul>
</li>
<li><a href="#_vert_x_sql_client">Vert.x SQL Client</a>
<ul class="sectlevel2">
<li><a href="#_client_builder">Client builder</a></li>
<li><a href="#_connect_options">Connect options</a></li>
<li><a href="#_pool_connect_handler">Pool connect handler</a></li>
<li><a href="#_pool_connection_provider">Pool connection provider</a></li>
</ul>
</li>
<li><a href="#_vert_x_mongo_client">Vert.x Mongo Client</a>
<ul class="sectlevel2">
<li><a href="#_upgrade_to_mongodb_java_driver_5">Upgrade to MongoDB Java Driver 5</a></li>
</ul>
</li>
<li><a href="#_vert_x_redis_client">Vert.x Redis Client</a>
<ul class="sectlevel2">
<li><a href="#_removal_of_request_null_argument">Removal of request null argument</a></li>
<li><a href="#_automatic_forwarding_of_redis_subscriptions_to_the_vert_x_event_bus">Automatic forwarding of Redis subscriptions to the Vert.x event bus</a></li>
<li><a href="#_rediscluster_groupbynodes_changed_return_type_code_generation_changes">RedisCluster.groupByNodes() changed return type + code generation changes</a></li>
<li><a href="#_json_serializationdeserialization_of_redisoptions">JSON serialization/deserialization of RedisOptions</a></li>
<li><a href="#_options_addendpointsetendpoint_replacements">Options addEndpoint/setEndpoint replacements</a></li>
</ul>
</li>
<li><a href="#_vert_x_rabbitmq_client">Vert.x RabbitMQ Client</a>
<ul class="sectlevel2">
<li><a href="#_establishing_a_connection">Establishing a Connection</a></li>
<li><a href="#_the_connectionestablishedcallback">The connectionEstablishedCallback</a></li>
<li><a href="#_consuming">Consuming</a></li>
<li><a href="#_publishing">Publishing</a></li>
</ul>
</li>
<li><a href="#_vert_x_consul_client">Vert.x Consul Client</a></li>
<li><a href="#_vert_x_health_check">Vert.x Health Check</a>
<ul class="sectlevel2">
<li><a href="#_health_checks_dependencies_improvements">Health checks dependencies improvements</a></li>
</ul>
</li>
<li><a href="#_vert_x_circuit_breaker">Vert.x Circuit Breaker</a>
<ul class="sectlevel2">
<li><a href="#_remove_deprecated_for_removal_retry_policy">Remove deprecated for removal retry policy</a></li>
</ul>
</li>
<li><a href="#_vert_x_mqtt">Vert.x MQTT</a>
<ul class="sectlevel2">
<li><a href="#_client_options_will_message_string_gettersetter_deprecated_removal">Client options will message string getter/setter deprecated removal</a></li>
</ul>
</li>
<li><a href="#_vert_x_mail_client">Vert.x Mail Client</a>
<ul class="sectlevel2">
<li><a href="#_remove_deprecated_mailconfig_setkeystoresetkeystorepassword">Remove deprecated MailConfig setKeyStore/setKeyStorePassword</a></li>
</ul>
</li>
<li><a href="#_vert_x_junit_5">Vert.x JUnit 5</a>
<ul class="sectlevel2">
<li><a href="#_remove_deprecated_test_context_succeeding">Remove deprecated test context succeeding</a></li>
</ul>
</li>
<li><a href="#_vert_x_service_proxy">Vert.x Service Proxy</a>
<ul class="sectlevel2">
<li><a href="#_serviceauthinterceptor_removal">ServiceAuthInterceptor removal</a></li>
<li><a href="#_servicebinder_functionnal_interceptor">ServiceBinder functionnal interceptor</a></li>
<li><a href="#_removal_of_proxyhelper_util_class">Removal of ProxyHelper util class</a></li>
</ul>
</li>
<li><a href="#_vert_x_reactive_extensions">Vert.x Reactive Extensions</a>
<ul class="sectlevel2">
<li><a href="#_data_object_changes">Data object changes</a></li>
</ul>
</li>
<li><a href="#_vert_x_micrometer_metrics">Vert.x Micrometer Metrics</a>
<ul class="sectlevel2">
<li><a href="#_upgrade_to_micrometer_1_14">Upgrade to Micrometer 1.14</a></li>
<li><a href="#_http_client_pool_metrics">HTTP client pool metrics</a></li>
<li><a href="#_remove_setting_a_registry_on_options">Remove setting a registry on options</a></li>
<li><a href="#_remove_influxdb_options_number_of_threads">Remove InfluxDB options number of threads</a></li>
<li><a href="#_rename_metrics_options_request_tag_provider">Rename metrics options request tag provider</a></li>
</ul>
</li>
<li><a href="#_vert_x_dropwizard_metrics">Vert.x Dropwizard Metrics</a>
<ul class="sectlevel2">
<li><a href="#_http_client_pool_metrics_2">HTTP client pool metrics</a></li>
<li><a href="#_remove_setting_a_metrics_registry_on_metrics_options">Remove setting a metrics registry on metrics options</a></li>
</ul>
</li>
<li><a href="#_vert_x_json_schema">Vert.x Json Schema</a>
<ul class="sectlevel2">
<li><a href="#_deprecated_apis_removal">Deprecated APIs removal</a></li>
<li><a href="#_additional_error_types">Additional Error Types</a></li>
<li><a href="#_removal_of_schematype_int_constant">Removal of SchemaType INT constant</a></li>
<li><a href="#_remove_of_validationexception_createexception_methods">Remove of ValidationException createException methods</a></li>
</ul>
</li>
<li><a href="#_vert_x_hazelcast">Vert.x Hazelcast</a>
<ul class="sectlevel2">
<li><a href="#_upgrade_to_hazelcast_5_3">Upgrade to Hazelcast 5.3</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide describes the updates in Eclipse Vert.x 5 release. Use the information to upgrade your Vert.x 4.x applications to Vert.x 5. It provides information about the new, deprecated and unsupported features in this release.</p>
</div>
<div class="paragraph">
<p>Depending on the modules used in your application, you can read the relevant section to know more about the changes in Vert.x 5.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_about_vert_x">About Vert.x</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x is a toolkit used for creating reactive, non-blocking, and asynchronous applications that run on Java Virtual Machine. (JVM). It contains several components that help you create reactive applications. It is designed to be cloud-native.</p>
</div>
<div class="paragraph">
<p>Since Vert.x supports asynchronous applications it can be used to create applications with high volume of messages, large event processing, HTTP interactions, and so on.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_whats_changed_in_vert_x_5">What&#8217;s changed in Vert.x 5</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section explains the fundamental differences between Vert.x 5 and 4.x releases.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_handling_deprecations_and_removals">Handling deprecations and removals</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some features and functions have been deprecated or removed in Vert.x 5. Before you migrate your applications to Vert.x 5, check for deprecations and removals.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some APIs were deprecated in an Vert.x 4.x release and new equivalent APIs were provided in that release.</p>
</li>
<li>
<p>The deprecated APIs have been removed in Vert.x 5.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If your application uses a deprecated API, you should update your application to use the new API. This helps in migrating applications to the latest version of the product.</p>
</div>
<div class="paragraph">
<p>The Java compiler generates warnings when deprecated APIs are used. You can use the compiler to check for deprecated methods while migrating applications to Vert.x 5.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_components_sunsets_and_removals">Components sunsets and removals</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A few components are sunsetting in 5, that means they are still supported for the lifetime of the 5.x series,
but we don’t encourage using them anymore since we provide replacements for them. Such components are scheduled
to go away in the next major release (Vert.x 6).</p>
</div>
<div class="paragraph">
<p>Here is the list of components sunsetting in 5:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Component</th>
<th class="tableblock halign-left valign-top">Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gRPC Netty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vert.x gRPC client and server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL client API implementation for JDBC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service Discovery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vert.x Service Resolver</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RxJava 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mutiny or RxJava 3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenTracing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenTelemetry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vert.x Unit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vert.x JUnit 5</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Here is the list of components removed in 5, that were sunset in the 4.x series.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Component</th>
<th class="tableblock halign-left valign-top">Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vert.x Sync</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vert.x virtual threads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service Factories</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maven Service Factory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP Service Factory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vert.x Web OpenAPI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://vertx.io/docs/vertx-web-openapi-router/java/">Vert.x Web OpenAPI Router</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_embracing_the_future_model">Embracing the future model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x 4 extended the 3.x callback asynchronous model to a future/callback hybrid model, to facilitate migration from Vert.x 3.</p>
</div>
<div class="paragraph">
<p>Every callback method has a matching future method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">HttpClient</span> {

   <span class="comment">// Future version</span>
   <span class="predefined-type">Future</span>&lt;HttpClientRequest&gt; request(RequestOptions request);

   <span class="comment">// Callback version</span>
   <span class="type">void</span> request(RequestOptions request, <span class="predefined-type">Handler</span>&lt;AsyncResult&lt;HttpClientRequest&gt;&gt; callback);
   ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Vert.x 5 only retains the future model and thus the callback model is gone, instead you get:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">HttpClient</span> {

   <span class="comment">// Future version</span>
   <span class="predefined-type">Future</span>&lt;HttpClientRequest&gt; request(RequestOptions request);
   ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Callback methods Vert.x 4.x are not deprecated methods, however after the release of Vert.x 5, the callback
methods shall be deprecated in order to facilitate the migration to Vert.x 5.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_builders">Vert.x builders</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x 5 has introduced the usage of the builder pattern that facilitate component configuration with instances of objects.</p>
</div>
<div class="paragraph">
<p>Until 5, such customisation was usually supported by options.</p>
</div>
<div class="listingblock">
<div class="title">Customizing a Vertx instance in Vert.x 4.x</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Future</span>&lt;Vertx&gt; future = Vertx.clusteredVertx(options.setClusterManager(clusterManager));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The builder pattern provide a clean and simple alternative to separate <em>configuration</em> and <em>customization</em>.</p>
</div>
<div class="listingblock">
<div class="title">Customizing a Vertx instance in Vert.x 5</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Future</span>&lt;Vertx&gt; f = Vertx
  .builder()
  .with(options)
  .withClusterManager(clusterManager)
  .buildClustered();</code></pre>
</div>
</div>
<div class="paragraph">
<p>This pattern has been adopted whenever possible in Vert.x 5 and will be detailed on a per component basis.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_changes_in_components">Changes in components</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_vert_x_command_line_tool_removal">Vert.x command-line tool removal</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>vertx</code> command-line tool has been removed in Vert.x 5.</p>
</div>
<div class="paragraph">
<p>We want to focus on the use case of the typical Vert.x application: compiled and optionally packaged as an executable uber-jar.</p>
</div>
<div class="paragraph">
<p>You can do this with Maven and the <a href="https://reactiverse.io/vertx-maven-plugin/">Vert.x Maven Plugin</a>.
The plugin can create a new Maven project in your repository or update an existing one.</p>
</div>
<div class="paragraph">
<p>In addition to packaging the application as an executable uber-jar, it can also start your application in development mode (redeploying the main verticle when file changes are detected).</p>
</div>
<div class="paragraph">
<p>If you&#8217;re a Gradle user, the <a href="https://github.com/jponge/vertx-gradle-plugin">Vert.x Gradle Plugin</a> provides similar features.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cli_framework_deprecation">CLI framework deprecation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The CLI framework is deprecated in Vert.x 5.
This includes the <code>io.vertx.core.Launcher</code> class, which is based on it.</p>
</div>
<div class="paragraph">
<p>If your application is a command-line tool or needs one, checkout alternatives like <a href="https://picocli.info/">Picocli</a>.
In fact, in various aspects, Picocli is more flexible and more powerful than the Vert.x CLI framework.</p>
</div>
<div class="sect2">
<h3 id="_vert_x_legacy_cli">Vert.x Legacy CLI</h3>
<div class="paragraph">
<p>If, while evaluating alternatives, you need to preserve the CLI framework functionality, you may do so by adding this dependency to your project (Maven):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.vertx<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>vertx-launcher-legacy-cli<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>5.0.0<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This new project contains the legacy CLI framework, including the <code>io.vertx.core.Launcher</code> class.</p>
</div>
<div class="paragraph">
<p>Beware it is not guaranteed that backward compatibility can be maintained for the whole Vert.x 5 lifetime.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vert_x_application_launcher">Vert.x Application Launcher</h3>
<div class="paragraph">
<p>In Vert.x 5, a new module, the <a href="https://vertx.io/docs/vertx-application-launcher/java/">Vert.x Application Launcher</a> replaces the Vert.x 4.x <code>io.vertx.core.Launcher</code> class.</p>
</div>
<div class="paragraph">
<p>First, you must add it to your project&#8217;s dependencies (Maven):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.vertx<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>vertx-launcher-application<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>5.0.0<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To start your application, use <code>io.vertx.launcher.application.VertxApplication</code> as the main class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell"># Assuming the command is executed on a Unix-like system which has the classpath configured in the CLASSPATH environment variable.
java -cp $CLASSPATH io.vertx.launcher.application.VertxApplication my.app.MainVerticle</code></pre>
</div>
</div>
<div class="paragraph">
<p>If your application is packaged as an executable JAR, having the <code>Main-Class</code> attribute set to <code>io.vertx.launcher.application.VertxApplication</code> in the <code>META-INF/MANIFEST.MF</code> file, the command can be simplified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">java -jar myapp.jar my.app.MainVerticle</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_core">Vert.x Core</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_vert_x_instance_customization">Vert.x instance customization</h3>
<div class="paragraph">
<p>An instance of <code>Vertx</code> can be customized with a few moving parts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cluster manager</p>
</li>
<li>
<p>metrics factory</p>
</li>
<li>
<p>tracing factory</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In Vert.x 5 customization is achieved by the <code>VertxBuilder</code>.</p>
</div>
<div class="listingblock">
<div class="title">Customizing with a cluster manager</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
<span class="predefined-type">Future</span>&lt;Vertx&gt; f = Vertx.clusteredVertx(
  <span class="keyword">new</span> VertxOptions().setClusterManager(clusterManager)
);

<span class="comment">// 5.0</span>
<span class="predefined-type">Future</span>&lt;Vertx&gt; f = Vertx
  .builder()
  .withClusterManager(clusterManager)
  .buildClustered();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Likewise, metrics and tracing factories are configured similarly</p>
</div>
<div class="listingblock">
<div class="title">Customizing with tracing/metrics factories</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
Vertx vertx = Vertx.vertx(
  <span class="keyword">new</span> VertxOptions()
    .setMetricsOptions(<span class="keyword">new</span> MetricsOptions().setEnabled(<span class="predefined-constant">true</span>).setFactory(factory))
    .setTracingOptions(<span class="keyword">new</span> TracingOptions().setFactory(factory))
);

<span class="comment">// 5.0</span>
Vertx vertx = Vertx
   .builder()
  .withMetrics(factory)
  .withTracer(factory)
  .build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The tracing implementations of Vert.x have been updated accordingly to support customizing with a tracer implementation for this purpose:</p>
</div>
<div class="listingblock">
<div class="title">Customizing an instance with an OpenTelemetry instance</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
Vertx vertx = Vertx.vertx(<span class="keyword">new</span> VertxOptions()
    .setTracingOptions(
      <span class="keyword">new</span> OpenTelemetryOptions(openTelemetry)
    )
  );

<span class="comment">// 5.0</span>
Vertx vertx = Vertx.builder()
 .withTracer(<span class="keyword">new</span> OpenTelemetryTracingFactory(openTelemetry))
 .build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The metrics implementations of Vert.x have been updated accordingly to support customizing with a metrics implementation for this purpose:</p>
</div>
<div class="listingblock">
<div class="title">Customizing an instance with a Dropwizard metrics registry</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
Vertx vertx = Vertx.vertx(<span class="keyword">new</span> VertxOptions()
 .setMetricsOptions(<span class="keyword">new</span> DropwizardMetricsOptions()
   .setMetricsRegistry(myRegistry)
   .setEnabled(<span class="predefined-constant">true</span>)));

<span class="comment">// 5.0</span>
Vertx vertx = Vertx.builder()
  .with(<span class="keyword">new</span> VertxOptions()
    .setMetricsOptions(<span class="keyword">new</span> DropwizardMetricsOptions()
    .setEnabled(<span class="predefined-constant">true</span>)))
  .withMetrics(<span class="keyword">new</span> DropwizardMetricsFactory(myRegistry))
  .build();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_http_related_changes">HTTP related changes</h3>
<div class="sect3">
<h4 id="_http2_connection_shutdown_handler">HTTP/2 connection shutdown handler</h4>
<div class="paragraph">
<p>The HTTP/2 connection shutdown handler notifies the handler when the connection shutdown begins, previously the handler was notified when after all the connection streams have been closed. The previous behavior can be obtained with the connection close handler.</p>
</div>
<div class="paragraph">
<p>This allows to be aware of a connection shutdown and take appropriate measures to stop the inflight streams being processed. It also aligns with the behaviour of other shutdown handlers.</p>
</div>
</div>
<div class="sect3">
<h4 id="_removal_of_http_connection_shutdown_variant_without_a_timeunit">Removal of HTTP connection shutdown variant without a timeunit</h4>
<div class="paragraph">
<p>The <code>HttpConnection#shutdown(long)</code> variant is removed in favor of <code>HttpConnection#shutdown(long, TimeUnit)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
connection.shutdown(<span class="integer">5</span> * <span class="integer">1000</span>); <span class="comment">// 5 seconds</span>

<span class="comment">// 5.0</span>
connection.shutdown(<span class="integer">5</span>, <span class="predefined-type">TimeUnit</span>.SECONDS); <span class="comment">// 5 seconds</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_removal_of_http_server_response_push_with_a_string_authority">Removal of HTTP server response push with a string authority</h4>
<div class="paragraph">
<p><code>HttpServerResponse#push</code> methods with a string <em>authority</em> have been removed in favour of the same method with an <code>HostAndPort</code> type instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
response.push(httpMethod, authorityAsString path);

<span class="comment">// 5.0</span>
response.push(httpMethod, HostAndPort.parse(authorityAsString) path);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_removal_of_http_server_request_cookie_map_method">Removal of HTTP server request cookie map method</h4>
<div class="paragraph">
<p>The deprecated <code>HttpServerRequest#cookieMap</code> method has been removed, instead the <code>HttpServerRequest#cookies</code> method should be used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Cookie&gt; cookieMap = request.cookieMap();

<span class="comment">// 5.0</span>
<span class="predefined-type">Set</span>&lt;Cookie&gt; cookies = request.cookies();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_use_of_uniform_byte_distributor_for_http2_streams">Use of uniform byte distributor for HTTP/2 streams</h4>
<div class="paragraph">
<p>The default stream byte distributor use stream priorities to determine the amount of bytes to be sent for each stream, this change allows to use a strategy that does not use stream priorities and yields better performance since it consumes less CPU.</p>
</div>
<div class="paragraph">
<p>The default implementation is now <code>UniformStreamByteDistributor</code> instead of <code>WeightedFairQueueByteDistributor</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_rename_httpclientrequest_settimeout_to_setidletimeout">Rename HttpClientRequest setTimeout to setIdleTimeout</h4>
<div class="paragraph">
<p>The request timeout is actually an idle timeout, it has been renamed to avoid confusion.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
request.setTimeout(timeout);

<span class="comment">// 5.0</span>
request.setIdleTimeout(timeout);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_removal_of_httpclient_websocket_methods">Removal of HttpClient WebSocket methods</h4>
<div class="paragraph">
<p><code>HttpClient</code> WebSocket methods are moved to a new <code>WebSocketClient</code> API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
HttpClient httpClient = vertx.createHttpClient();
<span class="predefined-type">Future</span>&lt;WebSocket&gt; f = httpClient.webSocket(connectOptions);

<span class="comment">// 5.0</span>
WebSocketClient wsClient = vertx.createWebSocketClient();
<span class="predefined-type">Future</span>&lt;WebSocket&gt; f = wsClient.connect(connectOptions);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_http_client_customization">HTTP client customization</h4>
<div class="paragraph">
<p><code>HttpClient</code> customization methods have been moved to a new <code>HttpClientBuilder</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>redirectHandler</code></p>
</li>
<li>
<p><code>connectionHandler</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
HttpClient client = vertx.createHttpClient();
client.connectionHandler(conn -&gt; ...);
client.redirectHandler(request -&gt; ...);

<span class="comment">// 5.0</span>
HttpClient client = vertx.httpClientBuilder()
  .withConnectHandler(conn -&gt; ...)
  .withRedirectHandler(request -&gt; ...)
  .build();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_httpclient_api_cleanup">HttpClient API cleanup</h4>
<div class="paragraph">
<p>In Vert.x 4.x, <code>HttpClient</code> API exposes two distincts API:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HTTP interactions, like <code>request</code> method.</p>
</li>
<li>
<p>HTTP client operations, like <code>updateSSLOptions</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Since Vert.x 5, <code>HttpClient</code> only retains HTTP interactions, a new <code>HttpClientAgent</code> API extends <code>HttpClient</code> and exposes
these methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
HttpClient client = vertx.createHttpClient();
client.updateSSLOptions(sslOptions);

<span class="comment">// 5.0</span>
HttpClientAgent client = vertx.createHttpClient();
client.updateSSLOptions(sslOptions);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_httpclient_pool_configuration">HttpClient pool configuration</h4>
<div class="paragraph">
<p>In Vert.x 4.x, <code>HttpClientOptions</code> configures the HTTP/1.x and HTTP/2 pool.</p>
</div>
<div class="paragraph">
<p>Since Vert.x 5, this configuration is done through <code>PoolOptions</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
HttpClient client = vertx.createHttpClient(<span class="keyword">new</span> HttpClientOptions()
  .setMaxPoolSize(http1MaxPoolSize)
  .setHttp2MaxPoolSize(http2MaxPoolSize)
);

<span class="comment">// 5.0</span>
HttpClient client = vertx.createHttpClient(<span class="keyword">new</span> PoolOptions()
  .setHttp1MaxSize(http1MaxPoolSize)
  .setHttp2MaxSize(http2MaxPoolSize)
);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_removal_of_httpserverresponse_close_method">Removal of HttpServerResponse close method</h4>
<div class="paragraph">
<p>The <code>HttpServerResponse</code> close method closes the HTTP connection, it can be misleading as there are better API to interact
with the current request/connection lifecycle which are <code>HttpServerResponse#reset</code> and <code>HttpConnection#close</code>.</p>
</div>
<div class="paragraph">
<p>When the actual HTTP connection must be closed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
response.close();

<span class="comment">// 5.0</span>
request.connection().close();</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the current request/response must be disposed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
response.close();

<span class="comment">// 5.0</span>
response.reset();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_http_stream_async_methods_returns_now_a_future_instead_of_being_fluent">HTTP stream async methods returns now a future instead of being fluent</h4>
<div class="paragraph">
<p>A few methods have seen their fluent return type to be changed to a future type instead in order to signal
the completion result:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>writeCustomFrame</code></p>
</li>
<li>
<p><code>writeContinue</code></p>
</li>
<li>
<p><code>reset</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
response.writeCustomFrame(<span class="integer">12</span>, <span class="integer">134</span>, expectedRecv).end();

<span class="comment">// 5.0</span>
response.writeCustomFrame(<span class="integer">12</span>, <span class="integer">134</span>, expectedRecv);
response.end();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_new_authority_property_replacing_hostport">New authority property replacing host/port</h4>
<div class="paragraph">
<p><code>HttpClientRequest</code> and <code>HttpServerRequest</code> expose the request authority using a host/port combination for the client
request and a single host header for the server. In addition, this terminology is also confusing with the actual server
host and port.</p>
</div>
<div class="paragraph">
<p>Those are replaced by a new <em>authority</em> property:</p>
</div>
<div class="listingblock">
<div class="title">Client request</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
request.setHost(host).setPort(port);

<span class="comment">// 5.0</span>
request.authority(HostAndPort.create(host, port));</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Server request</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
<span class="predefined-type">String</span> host = request.host(); <span class="comment">// host:port string</span>

<span class="comment">// 5.0</span>
HostAndPort authority = request.authority();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_httpserver_request_and_websocket_streams_removal">HttpServer request and WebSocket streams removal</h4>
<div class="paragraph">
<p><code>HttpServer#requestStream()</code> and <code>HttpServer#timeoutStream()</code> have been removed. These streams were designed for Rx like
 languages and the actually don&#8217;t provide any benefits.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
server.requestStream().handler(request -&gt; ...);

<span class="comment">// 5.0</span>
server.requestHandler(request -&gt; ...).listen();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_removal_of_server_websocket_handshake_methods">Removal of server WebSocket handshake methods</h4>
<div class="paragraph">
<p>The server WebSocket API can control handshake implicitly (e.g. sending a message) or explicitly (accept or any WebSocket interaction). This result in a more complex implementation than it should be for such API.</p>
</div>
<div class="listingblock">
<div class="title">Accepting a handshake</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
server.webSocketHandler(ws -&gt; {
  ws.accept();
  ws.write();
};

<span class="comment">// 5.0</span>
server.webSocketHandshakeHandler(handshake -&gt; {
  handshake.accept();
});
server.webSocketHandler(ws -&gt; {
  ws.write();
};</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Rejecting a handshake</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
server.webSocketHandler(ws -&gt; {
  ws.reject();
};

<span class="comment">// 5.0</span>
server.webSocketHandshakeHandler(handshake -&gt; {
  handshake.reject();
});</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_future">Future</h3>
<div class="sect3">
<h4 id="_compositefuture_raw_future_type_removal">CompositeFuture raw Future type removal</h4>
<div class="paragraph">
<p><code>CompositeFuture</code> methods declare raw <code>Future</code> types, e.g. <code>all(Future,Future) or all(List&lt;Future&gt;&gt;)</code>, such declarations force the user to cast when using a <code>List&lt;Future&lt;Something&gt;&gt;</code>. These methods have been made fully generic, using the wildcard type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;<span class="predefined-type">Future</span>&lt;User&gt;&gt; users = ...

<span class="comment">// 4.x</span>
CompositeFuture cf = CompositeFuture.all((<span class="predefined-type">List</span>&lt;<span class="predefined-type">Future</span>&gt;)users);

<span class="comment">// 5.0</span>
CompositeFuture cf = <span class="predefined-type">Future</span>.all(users);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_removal_of_future_eventually_method_that_takes_a_function_as_argument">Removal of Future eventually method that takes a function as argument</h4>
<div class="paragraph">
<p><code>Future#eventually</code> method takes as parameter a <code>Function&lt;Void, Future&lt;T&gt;&gt;</code>, this was developed for codegen which does not support <code>Supplier</code>. The <code>Future</code> object is not code generated anymore since Vert.x 4.x, we can therefore use <code>Supplier</code> which is more suitable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
future.eventually(v -&gt; someFuture());

<span class="comment">// 5.0</span>
future.eventually(() -&gt; someFuture());</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_logging">Logging</h3>
<div class="paragraph">
<p>Vert.x Logging API usage has been reduced in Vert.x 4 to be used by Vert.x components, in other words
the API has become internal to Vert.x:</p>
</div>
<div class="paragraph">
<p><code>io.vertx.core.logging.Logger</code> and  <code>io.vertx.core.logging.LoggerFactory</code> have been deprecated to discourage usage of this API. Instead, a logging API should be used such as <a href="https://logging.apache.org/log4j/2.12.x/">Log4j 2</a> or <a href="https://www.slf4j.org">SLF4J</a>.</p>
</div>
<div class="paragraph">
<p>Of course, configuration of the Vert.x logging back-end remains fully supported as usual, like the <code>vertx.logger-delegate-factory-class-name</code> system property.</p>
</div>
</div>
<div class="sect2">
<h3 id="_system_properties">System properties</h3>
<div class="paragraph">
<p>A few system properties have been removed in Vert.x 5.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vertx.json.base64</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vert.x 3.x Json supports RFC-7493, however the JSON encoder/decoder format was incorrect. Users who needed to interop with Vert.x 3.x applications should have set the system property <code>vertx.json.base64</code> to <code>legacy</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vertx.cluster.managerClass</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not used, neither documented nor tested.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vertx.javaCompilerOptions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not used, neither documented nor tested.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vertx.flashPolicyHandler</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vert.x HTTP/1.1 server contains a hidden option to detect Adobe Flash clients and return a policy file response. This option is activated by a system property <code>vertx.flashPolicyHandler</code> only referenced in source code (private field) and not tested.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vertx.cwd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This system property was not documented and only used in the <code>vertx-examples</code> repository.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vertx.disableTCCL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Instead, <code>VertxOptions#setDisableTCCL(boolean)</code> should be used.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_worker_verticles">Worker verticles</h3>
<div class="sect3">
<h4 id="_removal_of_deployment_worker_property">Removal of deployment worker property</h4>
<div class="paragraph">
<p><code>DeploymentOptions#setWorker</code> and <code>DeploymentOptions#getWorker</code> methods are removed since the introduction of the new <code>ThreadingModel</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
<span class="predefined-type">Future</span>&lt;<span class="predefined-type">String</span>&gt; f = vertx.deployVerticle(<span class="keyword">new</span> DeploymentOptions().setWorker(<span class="predefined-constant">true</span>, ...)

<span class="comment">// 5.0</span>
<span class="predefined-type">Future</span>&lt;<span class="predefined-type">String</span>&gt; f = vertx.deployVerticle(<span class="keyword">new</span> DeploymentOptions().setThreadingModel(ThreadingModel.WORKER, ...)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_worker_event_loop_assignment">Worker event-loop assignment</h4>
<div class="paragraph">
<p>Since Vert.x 5 worker deployment uses a single event-loop for all worker verticles instead of an event-loop per worker
instance.</p>
</div>
<div class="paragraph">
<p>Previously, this was following event-loop deployments which use an event-loop per verticle instance for scalability purpose.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_miscellaneous">Miscellaneous</h3>
<div class="sect3">
<h4 id="_netserver_connect_stream_removals">NetServer connect stream removals</h4>
<div class="paragraph">
<p><code>NetServer#connectStream()</code> has been removed. This stream was designed for Rx like languages and the actually don&#8217;t provide any benefits at the expense of the API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
server.connectStream().handler(socket -&gt; ...);

<span class="comment">// 5.0</span>
server.connectHandler(socket -&gt; ...).listen();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_timeoutstream_removal">TimeoutStream removal</h4>
<div class="paragraph">
<p><code>TimeoutStream</code> has been removed. This stream was designed for Rx like languages and the actually don&#8217;t provide any benefits at the expense of the API. Instead, the framework scheduler should be used instead along with a Vert.x context.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
vertx.periodicStream(<span class="integer">1L</span>).handler(timerID -&gt; ...);

<span class="comment">// 5.0</span>
server.setPeriodic(<span class="integer">1L</span>, timerID -&gt; ...);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For RxJava like integrations</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
<span class="predefined-type">Observable</span>&lt;<span class="predefined-type">Long</span>&gt; timer = vertx.periodicStream(<span class="integer">1000</span>).toObservable();

<span class="comment">// 5.0</span>
Scheduler scheduler = RxHelper.scheduler(vertx);
<span class="predefined-type">Observable</span>&lt;<span class="predefined-type">Long</span>&gt; timer = <span class="predefined-type">Observable</span>.interval(<span class="integer">100</span>, <span class="integer">100</span>, <span class="predefined-type">TimeUnit</span>.MILLISECONDS, scheduler);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_context_local_storage_removal">Context local storage removal</h4>
<div class="paragraph">
<p>The context local storage API has been removed from the public API since it should not have been public in the first place and is meant for extending Vert.x</p>
</div>
<div class="paragraph">
<p>Its methods have been moved to <code>io.vertx.core.internal.ContextInternal</code> interface and might be removed any time in Vert.x 5 since there is a alternative implementation for it (`io.vertx.core.spi.context.storage.ContextLocal).</p>
</div>
</div>
<div class="sect3">
<h4 id="_keycertoptions_key_manager_mapper_removal">keyCertOptions key manager mapper removal</h4>
<div class="paragraph">
<p><code>KeyCertOptions#keyManagerMapper()</code> method has been removed in Vert.x 5, implementors must instead implement <code>keyManagerFactoryMappermethod</code> that provides the opportunity to cache the <code>KeyManagerFactory</code> to the implementor that controls the lifecycle of the key manager.</p>
</div>
</div>
<div class="sect3">
<h4 id="_removal_of_execute_blocking_methods_with_a_handler_of_promise">Removal of execute blocking methods with a handler of promise</h4>
<div class="paragraph">
<p>The API for executing blocking actions uses a pattern with handler completing or failing a promise, instead this can be replaced with <code>java.util.concurrent.Callable</code> that returns the same value or throws an exception.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
<span class="predefined-type">Future</span>&lt;<span class="predefined-type">String</span>&gt; fut = vertx.executeBlocking(promise -&gt; promise.complete(<span class="string"><span class="delimiter">&quot;</span><span class="content">result</span><span class="delimiter">&quot;</span></span>));

<span class="comment">// 5.0</span>
<span class="predefined-type">Future</span>&lt;<span class="predefined-type">String</span>&gt; fut = vertx.executeBlocking(() -&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">result</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_processargs_methods_deprecated">processArgs methods deprecated</h4>
<div class="paragraph">
<p><code>io.vertx.core.Context#processArgs</code> and <code>io.vertx.core.AbstractVerticle#processArgs</code> are deprecated.</p>
</div>
<div class="paragraph">
<p>As of version 5, Vert.x is no longer tightly coupled to the CLI.</p>
</div>
</div>
<div class="sect3">
<h4 id="_netty_type_usage_removals">Netty type usage removals</h4>
<div class="paragraph">
<p>The Vert.x API exposes the Netty API in its public API, allowing interactions with the Netty API. Since Netty is evolving toward Netty 5, we should remove Netty API from the Vert.x public API in Vert.x 5 to have the opportunity to change the underlying Netty version used by Vert.x without worrying about the version of the Netty version.</p>
</div>
<div class="paragraph">
<p>Such API continues to exist in Vert.x 5 but is moved to internal API which is not contractual, therefore experimented users of this API can continue to use it granted that the version of Vert.x 5 uses Netty 4.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
ByteBuf bb = buff.getByteBuf();
<span class="predefined-type">Buffer</span> buf = <span class="predefined-type">Buffer</span>.buffer(bb);
EventLoopGroup group = vertx.nettyEventLoopGroup();

<span class="comment">// 5.0</span>
ByteBuf bb = ((BufferInternal)buff).getByteBuf();
buf = BufferInternal.buffer(bb);
group = ((VertxInternal)vertx).nettyEventLoopGroup();</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_auth">Vert.x Auth</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_authprovider_pruning">AuthProvider pruning</h3>
<div class="paragraph">
<p>io.vertx.ext.auth.AuthProvider` has been deprecated in Vert.x 4.0 in favour of <code>io.vertx.ext.auth.authentication.AuthenticationProvider</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
<span class="predefined-type">AuthProvider</span> authProvider = ...

<span class="comment">// 5.0</span>
AuthenticationProvider authProvider = ...</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_for_kotlin">Vert.x for Kotlin</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_removal_of_await_extension_methods_generation">Removal of await extension methods generation</h3>
<div class="paragraph">
<p>Vert.x 4.x for Kotlin generates suspending extension methods to facilitate the invocation of Vert.x asynchronous method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">suspend fun HttpServer.listenAwait(port: Int, host: String): HttpServer {
   return awaitResult {
     this.listen(port, host, it)
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Such methods have been deprecated since the equivalent can be achieved using a Vert.x future instance and removed
in Vert.x 5.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// 4.x
server.listenAwait(port, host)

// 5.0
server.listen(host, port).coAwait()</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_grpc">Vert.x gRPC</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_removal_of_grpcreadstreamcollecting_in_favour_of_readstreamcollect">Removal of GrpcReadStream#collecting in favour of ReadStream#collect</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
stream.collecting(collector);

<span class="comment">// 5.0</span>
stream.collect(collector);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_removal_of_methods_declaring_a_method_descriptor">Removal of methods declaring a method descriptor</h3>
<div class="paragraph">
<p><code>GrpcClient</code>/<code>GrpcServer</code> methods declaring a <code>MethodDescriptor</code> have been removed.</p>
</div>
<div class="paragraph">
<p>Instead, these methods are now available in <code>GrpcIoClient</code>/<code>GrpcIoServer</code> interfaces which extend <code>GrpcClient</code>/<code>GrpcServer</code> interfaces.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
GrpcServer server = GrpcServer.create(vertx);

<span class="comment">// 5.0</span>
GrpcIoServer server = GrpcIoServer.create(vertx);
server.callHandler(methodDescriptor, request -&gt; ...);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_web">Vert.x Web</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_routingcontext_user_api">RoutingContext user API</h3>
<div class="paragraph">
<p>User related operations have been moved under a single context API accessible from <code>RoutingContext</code></p>
</div>
<div class="sect3">
<h4 id="_logout">Logout</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
routingContext.clearUser();

<span class="comment">// 5.0</span>
UserContext userContext = routingContext.userContext();
userContext.logout();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_setting_a_user">Setting a user</h4>
<div class="paragraph">
<p>The <code>RoutingContext#setUser</code> method has been removed, this operation should be performed by authentication handlers instead.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_static_handler_configuration">Static handler configuration</h3>
<div class="paragraph">
<p><code>StaticHandler</code> methods <code>setAllowRootFileSystemAccess</code> and <code>setWebRoot</code> are removed after deprecation in Vert.x 4.x.</p>
</div>
<div class="paragraph">
<p>Instead, the handler must be configured at creation time:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
StaticHandler handler = StaticHandler.create().setAllowRootFileSystemAccess(<span class="predefined-constant">true</span>).setWebRoot(root);

<span class="comment">// 5.0</span>
StaticHandler handler = StaticHandler.create(FileSystemAccess.ROOT, root);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_web_client">Vert.x Web Client</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_response_expectation_replacement">Response expectation replacement</h3>
<div class="paragraph">
<p>Vert.x Core introduces a new API to implement expectation checks inspired from the Web Client response expectation feature.</p>
</div>
<div class="paragraph">
<p>The Vert.x HTTP Client comes with the same set of predefined expectations than the Web Client response expectations, more importantly HTTP client response expectations can be re-used by Web Client.</p>
</div>
<div class="paragraph">
<p>HTTP response expectations leverages the new <code>Future#expecting</code> operation combined with the <code>HttpResponseExpectation</code> implementation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
client
  .get(<span class="integer">8080</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">myserver.mycompany.com</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">/some-uri</span><span class="delimiter">&quot;</span></span>)
  .expect(ResponsePredicate.SC_SUCCESS)
  .send()
  .onSuccess(res -&gt; {
    <span class="comment">// ....</span>
  });

<span class="comment">// 5.0</span>
client
  .get(<span class="integer">8080</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">myserver.mycompany.com</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">/some-uri</span><span class="delimiter">&quot;</span></span>)
  .send()
  .expecting(HttpResponseExpectation.SC_SUCCESS)
  .onSuccess(res -&gt; {
    <span class="comment">// ....</span>
  });</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_web_graphql">Vert.x Web GraphQL</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_upgrade_to_graphql_java_22">Upgrade to GraphQL-Java 22</h3>
<div class="paragraph">
<p>GraphQL-Java 22 is a <a href="https://github.com/graphql-java/graphql-java/releases/tag/v22.0">breaking change release</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_web_validation">Vert.x Web Validation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_replacement_of_deprecated_schemaparser">Replacement of deprecated SchemaParser</h3>
<div class="paragraph">
<p>Vert.x Web Validation was based on a deprecated JSON Schema API, which is no longer available in Vert.x 5.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
ValidationHandlerBuilder.create(schemaParser)

<span class="comment">// 5.0</span>
SchemaRepository schemaRepo = SchemaRepository.create(<span class="keyword">new</span> JsonSchemaOptions().setDraft(DRAFT7));
ValidationHandlerBuilder.create(schemaRepo);</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
To improve security, the new <code>SchemaRepository</code> is not automatically loading external references. In case your schema contains an external references you must provide and dereference them upfront.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_sql_client">Vert.x SQL Client</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_client_builder">Client builder</h3>
<div class="paragraph">
<p>The <code>Pool</code> subtypes are not really useful as they don&#8217;t carry any extra method and are use mainly for statically building pool.</p>
</div>
<div class="paragraph">
<p>In addition, those static methods are not flexible and are numerous due to overloading.</p>
</div>
<div class="paragraph">
<p>We are replacing these methods with a new client builder API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
PgPool client = PgPool.pool(vertx, connectOptions, poolOptions);

<span class="comment">//5.0</span>
Pool client = PgBuilder.pool()
  .with(poolOptions)
  .connectingTo(connectOptions)
  .using(vertx)
  .build();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connect_options">Connect options</h3>
<div class="paragraph">
<p>The <code>SqlConnectOptions</code> class does not extend anymore <code>NetClientOptions</code> class.</p>
</div>
<div class="paragraph">
<p><code>SqlConnectOptions</code> TLS configuration still happens on this class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
<span class="comment">// 5.0</span>
PgConnectOptions options = <span class="keyword">new</span> PgConnectOptions()
  .setPort(port)
  .setHost(host)
  .setDatabase(database)
  .setUser(user)
  .setPassword(password)
  .setSslOptions(<span class="keyword">new</span> ClientSSLOptions()
    .setTrustOptions(<span class="keyword">new</span> PemTrustOptions().addCertPath(pathToCert))
  );</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>NetClientOptions</code> can still be passed when building a client thanks to the <code>ClientBuilder</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 5.0</span>
Pool pool = PgBuilder.pool()
      .connectingTo(connectOptions)
      .with(tcpOptions)
      .build();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pool_connect_handler">Pool connect handler</h3>
<div class="paragraph">
<p><code>Pool#connectHandler</code> method is moved to the new <code>ClientBuilder</code>, the handler is set once at build time instead
of being a mutable field of the pool implementations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
pool.connectHandler(connectHandler);

<span class="comment">// 5.0</span>
builder.connectHandler(connectHandler);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pool_connection_provider">Pool connection provider</h3>
<div class="paragraph">
<p><code>Pool#connectionProvider</code> method is replaced by a <code>Supplier&lt;Future&lt;SqlConnectOptions&gt;&gt;</code> builder method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
pool.connectionProvider(ctx -&gt; futureOfSqlConnection(ctx));

<span class="comment">// 5.0</span>
builder.connectingTo(() -&gt; futureOfSqlConnectOptions());</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_mongo_client">Vert.x Mongo Client</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_upgrade_to_mongodb_java_driver_5">Upgrade to MongoDB Java Driver 5</h3>
<div class="paragraph">
<p>MongoDB Java Driver 5.x is a <a href="https://www.mongodb.com/community/forums/t/mongodb-java-driver-5-0-is-released/268913/1">breaking change release</a>.</p>
</div>
<div class="paragraph">
<p>In <code>IndexOptions</code>, <code>bucketSize</code> has been removed.</p>
</div>
<div class="paragraph">
<p>Besides, <code>StreamFactoryFactory</code> has been replaced by <code>TransportSettings</code>, and Netty is the only available transport.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_redis_client">Vert.x Redis Client</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_removal_of_request_null_argument">Removal of request null argument</h3>
<div class="paragraph">
<p>Redis does not accept <code>null</code> values in the request. The <code>Request#nullArg()</code> method therefore encoded <code>null</code> as the 4-character <code>"null"</code> string.</p>
</div>
<div class="paragraph">
<p>This method, which was deprecated in 4.x, is removed. All places that used it to encode the <code>null</code> value now throw an <code>IllegalArgumentException</code>.</p>
</div>
<div class="paragraph">
<p>If you use <code>null</code> values in Redis requests, you should stop doing that. To restore previous behavior, you should encode <code>null</code> values as <code>"null"</code> manually. This applies to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Request.arg(String)</code></p>
</li>
<li>
<p><code>Request.arg(Buffer)</code></p>
</li>
<li>
<p><code>Request.arg(JsonArray)</code>: both the array itself, and individual elements</p>
</li>
<li>
<p><code>Request.arg(JsonObject)</code>: both the object itself, and individual elements</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_automatic_forwarding_of_redis_subscriptions_to_the_vert_x_event_bus">Automatic forwarding of Redis subscriptions to the Vert.x event bus</h3>
<div class="paragraph">
<p>In Vert.x 4.x, the Redis subscriptions were automatically forwarded to the event bus, unless the message handler was set explicitly (using <code>RedisConnection.handler()</code>).</p>
</div>
<div class="paragraph">
<p>This is no longer the case. Since Vert.x 5, you always have to register a message handler. If you still want the subscription messages forwarded to the event bus, you have to manually create an instance of <code>EventBusHandler</code> and register it using <code>RedisConnection.handler()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">RedisConnection conn = ...;
conn.handler(EventBusHandler.create(vertx));
conn.send(Request.cmd(Command.SUBSCRIBE).arg(<span class="string"><span class="delimiter">&quot;</span><span class="content">news</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition, the <code>EventBusHandler</code> does not forward only messages (<code>[p]message</code>); it also forwards subscriptions and un-subscriptions (<code>[p]subscribe</code> and <code>[p]unsubscribe</code>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_rediscluster_groupbynodes_changed_return_type_code_generation_changes">RedisCluster.groupByNodes() changed return type + code generation changes</h3>
<div class="paragraph">
<p>The <code>RedisCluster#groupByNodes()</code> method used to return <code>Future&lt;List&lt;List&lt;Request&gt;&gt;&gt;</code>. Due to this return type, the <code>RedisCluster</code> wasn&#8217;t <code>@VertxGen</code>.</p>
</div>
<div class="paragraph">
<p>This has changed in Vert.x 5. The <code>groupByNodes()</code> method now returns <code>Future&lt;RequestGrouping&gt;</code> and the entire interface is <code>@VertxGen</code>.</p>
</div>
<div class="paragraph">
<p>Further, the <code>Request</code>, <code>Response</code> and <code>Command</code> interfaces are no longer <code>@VertxGen</code>&#8201;&#8212;&#8201;instead, they are <code>@DataObject</code>. This means that users of code-generated APIs (such as Vert.x Rx) will no longer use the generated wrappers; they will use the core Vert.x Redis interfaces.</p>
</div>
</div>
<div class="sect2">
<h3 id="_json_serializationdeserialization_of_redisoptions">JSON serialization/deserialization of RedisOptions</h3>
<div class="paragraph">
<p>The <code>RedisOptions</code> class has multiple methods to configure the Redis endpoints. These methods are still available, but the JSON format of this class has changed to only include one canonical field: <code>endpoints</code>.</p>
</div>
<div class="paragraph">
<p>If you rely on the JSON form of <code>RedisOptions</code> objects, note that the <code>endpoint</code>, <code>connectionString</code> and <code>connectionStrings</code> members of the JSON object are no longer recognized by the deserializer and are no longer generated by the serializer. Ensure that the necessary information is present in the <code>endpoints</code> member.</p>
</div>
</div>
<div class="sect2">
<h3 id="_options_addendpointsetendpoint_replacements">Options addEndpoint/setEndpoint replacements</h3>
<div class="paragraph">
<p><code>RedisOptions#addEndpoint</code> and <code>RedisOptions#setEndpoint</code> are replaced by <code>RedisOptions#addConnectionString</code> and <code>RedisOptions#setConnectionString</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
options.setEndpoint(location);

<span class="comment">// 4.x</span>
options.setConnectionString(location);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_rabbitmq_client">Vert.x RabbitMQ Client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The 4.x RabbitMQ client library presented a high level abstraction of the RabbitMQ API that unfortunately
made some RabbitMQ uses impossible.
This has meant that the 5.0 RabbitMQ client library is a complete rewrite with a very different API.</p>
</div>
<div class="sect2">
<h3 id="_establishing_a_connection">Establishing a Connection</h3>
<div class="paragraph">
<p>The 4.x RabbitMQ client library uses a single RabbitMQClient that encapsulates the connection and the channel,
for the 5.0 client library these two are handled separately and it is possible to have multiple channels per connection.</p>
</div>
<div class="paragraph">
<p>The 5.0 RabbitMQChannel has the closest API to the 4.x RabbitMQClient.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
    RabbitMQOptions config = <span class="keyword">new</span> RabbitMQOptions();
    <span class="comment">// full amqp uri</span>
    config.setUri(<span class="string"><span class="delimiter">&quot;</span><span class="content">amqp://xvjvsrrc:VbuL1atClKt7zVNQha0bnnScbNvGiqgb@brokerhost/vhost</span><span class="delimiter">&quot;</span></span>);
    RabbitMQClient client = RabbitMQClient.create(vertx, config);

    <span class="comment">// Connect</span>
    client.start(asyncResult -&gt; {
      <span class="keyword">if</span> (asyncResult.succeeded()) {
        logger.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">RabbitMQ successfully connected!</span><span class="delimiter">&quot;</span></span>);
      } <span class="keyword">else</span> {
        logger.warning(<span class="string"><span class="delimiter">&quot;</span><span class="content">Failed to connect to RabbitMQ: {0}</span><span class="delimiter">&quot;</span></span>, asyncResult.cause().getMessage());
      }
    });

<span class="comment">// 5.0</span>
    RabbitMQOptions config = <span class="keyword">new</span> RabbitMQOptions();
    config.setUri(<span class="string"><span class="delimiter">&quot;</span><span class="content">amqp://brokerhost/vhost</span><span class="delimiter">&quot;</span></span>);
    config.setConnectionName(<span class="local-variable">this</span>.getClass().getSimpleName());
    config.setUser(<span class="string"><span class="delimiter">&quot;</span><span class="content">guest</span><span class="delimiter">&quot;</span></span>);
    config.setPassword(<span class="string"><span class="delimiter">&quot;</span><span class="content">guest</span><span class="delimiter">&quot;</span></span>);

    RabbitMQClient.connect(vertx, config)
            .compose(connection -&gt; {
              RabbitMQChannelBuilder builder = connection.createChannelBuilder();
              <span class="keyword">return</span> builder.openChannel();
            })
            .onSuccess(channel -&gt; logger.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">Channel opened: {0}</span><span class="delimiter">&quot;</span></span>, channel.getChannelId()))
            .onFailure(ex -&gt; logger.warning(<span class="string"><span class="delimiter">&quot;</span><span class="content">Failed to connect to RabbitMQ: {0}</span><span class="delimiter">&quot;</span></span>, ex))
            ;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_connectionestablishedcallback">The connectionEstablishedCallback</h3>
<div class="paragraph">
<p>An asynchronous RabbitMQ client with automatic reconnects must provide a way to create exchanges and queues before the channel is available for use.
In the 4.x library this is done with a single connectionEstablishedCallback added to the RabbitMQClient, for the 5.0 library it is done with a
channelOpenHandler that must be declared before the channel is opened.</p>
</div>
<div class="paragraph">
<p>The 4.x connectionEstablishedCallback passes in the RabbitMQClient, with the 5.0 library the RabbitMQChannel has not been established at the time that
the channelOpenHandler is called, so it passes in the raw com.rabbitmq.client.Channel.
The channelOpenHandler is called inside a blocking handler.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
    RabbitMQClient client = RabbitMQClient.create(vertx, config);
    client.addConnectionEstablishedCallback(promise -&gt; {
                client.exchangeDeclare(EXCHANGE_NAME, EXCHANGE_TYPE, EXCHANGE_DURABLE, EXCHANGE_AUTO_DELETE)
                    .compose(v -&gt; {
                      <span class="keyword">return</span> client.queueDeclare(QUEUE_NAME, QUEUE_DURABLE, QUEUE_EXCLUSIVE, QUEUE_AUTO_DELETE);
                    })
                    .compose(declareOk -&gt; {
                      <span class="keyword">return</span> client.queueBind(QUEUE_NAME, EXCHANGE_NAME, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>);
                    })
                    .onComplete(promise);
    });

<span class="comment">// 5.0</span>
    RabbitMQClient.connect(vertx, config)
            .compose(connection -&gt; {
              <span class="keyword">return</span> connection.createChannelBuilder()
                      .withChannelOpenHandler(chann -&gt; {
                        chann.exchangeDeclare(EXCHANGE_NAME, EXCHANGE_TYPE, EXCHANGE_DURABLE, EXCHANGE_AUTO_DELETE, <span class="predefined-constant">null</span>);
                        chann.queueDeclare(QUEUE_NAME, QUEUE_DURABLE, QUEUE_EXCLUSIVE, QUEUE_AUTO_DELETE, <span class="predefined-constant">null</span>);
                        chann.queueBind(QUEUE_NAME, EXCHANGE_NAME, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">null</span>);
                      })
                      .openChannel();
            })
            ;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_consuming">Consuming</h3>
<div class="paragraph">
<p>The 5.0 library RabbitMQChannel object exposes the basicConsume method, but it is recommended that
a RabbitMQConsumer is used to provide the messages as a Vert.x ReadStream.</p>
</div>
<div class="paragraph">
<p>Unless every message can be handled synchronously without any blocking calls there may be multiple messages
in flight within the consumer concurrently.
It is important that RabbitMQ QOS is used to restrict the number of messages received by the client.</p>
</div>
<div class="paragraph">
<p>Note the use of the STRING_MESSAGE_CODEC to convert the message body to a string before the callback is called.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
    client.basicConsumer(QUEUE_NAME, rabbitMQConsumerAsyncResult -&gt; {
      <span class="keyword">if</span> (rabbitMQConsumerAsyncResult.succeeded()) {
        RabbitMQConsumer mqConsumer = rabbitMQConsumerAsyncResult.result();
        mqConsumer.handler(message -&gt; {
          <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Got message: </span><span class="delimiter">&quot;</span></span> + message.body().toString());
        });
      }
    });

<span class="comment">// 5.0</span>
    connection.createChannelBuilder()
            .withQos(<span class="integer">0</span>, <span class="integer">10</span>)
            .createConsumer(RabbitMQChannelBuilder.STRING_MESSAGE_CODEC
                    , QUEUE_NAME
                    , <span class="predefined-constant">null</span>
                    , <span class="keyword">new</span> RabbitMQConsumerOptions()
                    , (consumer, message) -&gt; {
                      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Got message: </span><span class="delimiter">&quot;</span></span> + message.body());
                      <span class="keyword">return</span> message.basicAck();
                    });</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_publishing">Publishing</h3>
<div class="paragraph">
<p>RabbitMQ provides two options for messages, it can either guarantee that consumers receive a message no more than once,
or it can guarantee that consumers receive a message at least once.
The first of these is the default and requires nothing beyond a call to basicPublish, but published messages may be lost and not delivered at all.</p>
</div>
<div class="paragraph">
<p>In order to guarantee that a message is received the publisher must wait for confirmation from RabbitMQ - if that confirmation has not arrived
before the connection to the broker is broken the publisher must resend the message when the broker returns.</p>
</div>
<div class="paragraph">
<p>The Vert.x RabbitMQ library provides a RabbitMQPublisher to make asynchronous handling of confirmations simpler.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, JsonObject&gt; messages = ...
    RabbitMQPublisher publisher = RabbitMQPublisher.create(vertx, client, options);

    publisher.getConfirmationStream().handler(conf -&gt; {
      <span class="keyword">if</span> (conf.isSucceeded()) {
        messages.remove(conf.getMessageId());
      }
    });

    messages.forEach((k,v) -&gt; {
      com.rabbitmq.client.BasicProperties properties = <span class="keyword">new</span> AMQP.BasicProperties.Builder()
              .messageId(k)
              .build();
      publisher.publish(EXCHANGE_NAME, ROUTING_KEY, properties, v.toBuffer());
    });

    <span class="comment">// Wait for messages to be empty</span>


<span class="comment">// 5.0</span>
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, JsonObject&gt; messages = ...
    RabbitMQClient.connect(vertx, config)
            .compose(connection -&gt; {
              <span class="keyword">return</span> connection.createChannelBuilder()
                      .createPublisher(EXCHANGE_NAME
                              , RabbitMQChannelBuilder.JSON_OBJECT_MESSAGE_CODEC
                              , <span class="keyword">new</span> RabbitMQPublisherOptions().setResendOnReconnect(<span class="predefined-constant">true</span>)
                      );
            })
            .compose(publisher -&gt; {
              <span class="predefined-type">List</span>&lt;<span class="predefined-type">Future</span>&lt;<span class="predefined-type">Void</span>&gt;&gt; futures = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;(messages.size());
              messages.forEach((k,v) -&gt; {
                AMQP.BasicProperties properties = <span class="keyword">new</span> AMQP.BasicProperties.Builder()
                        .messageId(k)
                        .build();
                futures.add(publisher.publish(ROUTING_KEY, properties, v));
              });

              <span class="keyword">return</span> <span class="predefined-type">Future</span>.all(futures);
            })
            .onSuccess(v -&gt; logger.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">All message sent and confirmed</span><span class="delimiter">&quot;</span></span>))
            .onFailure(ex -&gt; logger.log(<span class="predefined-type">Level</span>.SEVERE, <span class="string"><span class="delimiter">&quot;</span><span class="content">Failed: {0}</span><span class="delimiter">&quot;</span></span>, ex))
            ;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_consul_client">Vert.x Consul Client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>io.vertx.ext.consul.AclToken</code> has been removed, instead <code>io.vertx.ext.consul.token.AclToken</code> should be used.</p>
</div>
<div class="paragraph">
<p>These deprecated API methods has been removed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Check#getNodeName()</code>, instead <code>Check#getNode()</code> should be used.</p>
</li>
<li>
<p><code>ConsulClient#createAclToken(io.vertx.ext.consul.AclToken)</code>, instead use <code>createAclToken(io.vertx.ext.consul.token.AclToken)</code></p>
</li>
<li>
<p><code>ConsulClient#updateAclToken(io.vertx.ext.consul.AclToken)</code>, instead use <code>updateAclToken(String, io.vertx.ext.consul.token.AclToken)</code></p>
</li>
<li>
<p><code>ConsulClient#cloneAclToken(String)</code>, instead use <code>cloneAclToken(String, CloneAclTokenOptions)</code></p>
</li>
<li>
<p><code>ConsulClient#infoAclToken(String)</code>, instead use <code>readAclToken(String)</code></p>
</li>
<li>
<p><code>ConsulClient#destroyAclToken(String)</code>, instead use <code>deleteAclToken(String)</code></p>
</li>
<li>
<p><code>ConsulClient#listAclTokens()</code>, instead use <code>getAclTokens()</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_health_check">Vert.x Health Check</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_health_checks_dependencies_improvements">Health checks dependencies improvements</h3>
<div class="paragraph">
<p>Previously, Vert.x Health Check depended on Vert.x Web and Vert.x Auth. It now only defines the health check API, the health check route handler has been moved to Vert.x Web.</p>
</div>
<div class="paragraph">
<p>This result in a package change in import declarations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
<span class="keyword">import</span> <span class="include">io.vertx.ext.healthchecks.HealthCheckHandler</span>;

<span class="comment">// 5.0</span>
<span class="keyword">import</span> <span class="include">io.vertx.ext.web.healthchecks.HealthCheckHandler</span>;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_circuit_breaker">Vert.x Circuit Breaker</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_remove_deprecated_for_removal_retry_policy">Remove deprecated for removal retry policy</h3>
<div class="paragraph">
<p>The circuit breaker retry policy with a Java function argument has been removed after deprecation in 4.x.</p>
</div>
<div class="paragraph">
<p>Instead, the <code>RetryPolicy</code> functional interface should be used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
breaker.retryPolicy(retryCount -&gt; <span class="integer">5</span>);

<span class="comment">// 5.0</span>
breaker.retryPolicy((failure, retryCount) -&gt; <span class="integer">5</span>);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_mqtt">Vert.x MQTT</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_client_options_will_message_string_gettersetter_deprecated_removal">Client options will message string getter/setter deprecated removal</h3>
<div class="paragraph">
<p>Client options <em>will</em> message <em>string</em> getter/setter have been removed after deprecation in 4.x.</p>
</div>
<div class="paragraph">
<p>Instead, the <code>Buffer</code> version should be used</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
options.setWillMessage(str);

<span class="comment">// 5.0</span>
options.setWillMessageBytes(<span class="predefined-type">Buffer</span>.buffer(str));</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_mail_client">Vert.x Mail Client</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_remove_deprecated_mailconfig_setkeystoresetkeystorepassword">Remove deprecated MailConfig setKeyStore/setKeyStorePassword</h3>
<div class="paragraph">
<p>Remove deprecated <code>MailConfig#setKeyStore</code> and <code>MailConfig#setKeyStorePassword</code> properties.</p>
</div>
<div class="paragraph">
<p>Instead, use MailConfig#setTrustOptions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
options.setKeyStore(trustStorePath);
options.setKeyStorePassword(trustStorePassword);

<span class="comment">// 5.0</span>
options.setTrustOptions(<span class="keyword">new</span> JksOptions().setPath(trustStorePath).setPassword(trustStorePassword));</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_junit_5">Vert.x JUnit 5</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_remove_deprecated_test_context_succeeding">Remove deprecated test context succeeding</h3>
<div class="paragraph">
<p>Instead, use <code>succeedingThenComplete()</code> or <code>succeeding(Handler)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
someFuture.onComplete(testContext.succeeding());

<span class="comment">// 5.0</span>
someFuture.onComplete(testContex.succeedingThenComplete());</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_service_proxy">Vert.x Service Proxy</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_serviceauthinterceptor_removal">ServiceAuthInterceptor removal</h3>
<div class="paragraph">
<p>Instead, use <code>AuthorizationInterceptor</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
<span class="keyword">new</span> ServiceBinder(vertx)
   .addInterceptor(<span class="keyword">new</span> ServiceAuthInterceptor()...)
   .register(SomeService.class, service);

<span class="comment">// 5.0</span>
<span class="keyword">new</span> ServiceBinder(vertx)
   .addInterceptor(AuthorizationInterceptor.create(authorizationProvider)...)
   .register(SomeService.class, service);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_servicebinder_functionnal_interceptor">ServiceBinder functionnal interceptor</h3>
<div class="paragraph">
<p>The <code>ServiceBinder#addInterceptor(Function)</code> and <code>ServiceBinder#addInterceptor(String, Function)</code> have been removed in favor of the variant with the <code>ServiceInterceptor</code> functional interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
binder.addInterceptor(msg -&gt; vertx.timer(<span class="integer">10</span>, <span class="predefined-type">TimeUnit</span>.MILLISECONDS).map(msg));

<span class="comment">// 5.0</span>
binder.addInterceptor((vertx, interceptorContext, body) -&gt; vertx.timer(<span class="integer">10</span>, <span class="predefined-type">TimeUnit</span>.MILLISECONDS).map(body));</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_removal_of_proxyhelper_util_class">Removal of ProxyHelper util class</h3>
<div class="paragraph">
<p>The <code>ProxyHelper</code> util class is removed in favor of <code>ServiceProxyBuilder</code> / <code>ServiceBinder</code> equivalents.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
ProxyHelper.registerService(MyService.class, vertx, service, <span class="string"><span class="delimiter">&quot;</span><span class="content">the-address</span><span class="delimiter">&quot;</span></span>);
MyService proxy = ProxyHelper.createProxy(MyService.class, vertx, <span class="string"><span class="delimiter">&quot;</span><span class="content">the-address</span><span class="delimiter">&quot;</span></span>);

<span class="comment">// 5.0</span>
<span class="keyword">new</span> ServiceBinder(vertx)
  .setAddress(<span class="string"><span class="delimiter">&quot;</span><span class="content">the-address</span><span class="delimiter">&quot;</span></span>)
  .register(MyService.class, service);
MyService proxy = <span class="keyword">new</span> ServiceProxyBuilder(vertx)
  .setAddress(<span class="string"><span class="delimiter">&quot;</span><span class="content">the-address</span><span class="delimiter">&quot;</span></span>)
  .build(MyService.class)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_reactive_extensions">Vert.x Reactive Extensions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_data_object_changes">Data object changes</h3>
<div class="paragraph">
<p>A few classes of Vert.x which have been historically annotated with <code>@VertxGen</code> and thus considered as asynchronous types have been converted to data objects.</p>
</div>
<div class="paragraph">
<p>As consequence reactive streams like generators will not need anymore to wrap/unwrap this type which avoids un-necessary allocation.</p>
</div>
<div class="paragraph">
<p>This implies that these objects are not anymore wrapped by Vert.x RX and the type will have their package name changed.</p>
</div>
<div class="paragraph">
<p>The following classes have been promoted to data objects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>io.vertx.core.buffer.Buffer</code></p>
</li>
<li>
<p><code>io.vertx.core.net.HostAndPort</code></p>
</li>
<li>
<p><code>io.vertx.core.net.SocketAddress</code></p>
</li>
<li>
<p><code>io.vertx.core.net.SelfSignedCertificate</code></p>
</li>
<li>
<p><code>io.vertx.core.MultiMap</code></p>
</li>
<li>
<p><code>io.vertx.core.datagram.DatagramPacket</code></p>
</li>
<li>
<p><code>io.vertx.core.dns.MxRecord</code></p>
</li>
<li>
<p><code>io.vertx.core.dns.SrvRecord</code></p>
</li>
<li>
<p><code>io.vertx.core.file.FileProps</code></p>
</li>
<li>
<p><code>io.vertx.core.file.FileSystemProps</code></p>
</li>
<li>
<p><code>io.vertx.core.http.Cookie</code></p>
</li>
<li>
<p><code>io.vertx.core.http.HttpFrame</code></p>
</li>
<li>
<p><code>io.vertx.core.http.WebSocketFrame</code></p>
</li>
<li>
<p><code>io.vertx.core.json.JsonEvent</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Among all the types above, the Vert.x buffer type is likely the most impacting change.</p>
</div>
<div class="paragraph">
<p><code>io.vertx.core.buffer.Buffer</code> has historically been part of the API as an async generated type, annotated by <code>@VertxGen</code>. It has always been wrapped/unwrapped with reactive stream based like generators.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
io.vertx.reactivex.core.buffer.Buffer buffer = rxApi.getBuffer();

<span class="comment">// 5.0</span>
io.vertx.core.buffer.Buffer buffer = rxApi.getBuffer();</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
stream.write(io.vertx.reactivex.core.buffer.Buffer.buffer(<span class="string"><span class="delimiter">&quot;</span><span class="content">the-string</span><span class="delimiter">&quot;</span></span>));

<span class="comment">// 5.0</span>
stream.write(io.vertx.core.buffer.Buffer.buffer(<span class="string"><span class="delimiter">&quot;</span><span class="content">the-string</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same applies to the other types mentioned.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_micrometer_metrics">Vert.x Micrometer Metrics</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_upgrade_to_micrometer_1_14">Upgrade to Micrometer 1.14</h3>
<div class="paragraph">
<p>Micrometer 1.14 comes after 1.13, which is a breaking change release if you are using the PrometheusMeterRegistry API in your code.</p>
</div>
<div class="paragraph">
<p>Please take a look at Micrometer&#8217;s <a href="https://github.com/micrometer-metrics/micrometer/wiki/1.13-Migration-Guide">migration guide</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_http_client_pool_metrics">HTTP client pool metrics</h3>
<div class="paragraph">
<p>HTTP client pool metrics are now exposed as generic pool metrics with pool type http</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>vertx_http_client_queue_pending</code> → <code>vertx_pool_queue_pending</code></p>
</li>
<li>
<p><code>vertx_http_client_queue_time_seconds</code> → <code>vertx_pool_queue_time_seconds</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_remove_setting_a_registry_on_options">Remove setting a registry on options</h3>
<div class="paragraph">
<p>The micrometer options setter for a <code>MeterRegistry</code> has been removed in favour of the new <code>VertxBuilder</code> along with the <code>MicrometerMetricsFactory</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
Vertx vertx = Vertx.vertx(<span class="keyword">new</span> VertxOptions()
 .setMetricsOptions(<span class="keyword">new</span> MicrometerMetricsOptions()
   .setMicrometerRegistry(myRegistry)
   .setEnabled(<span class="predefined-constant">true</span>)));

<span class="comment">// 5.0</span>
Vertx vertx = Vertx.builder()
  .with(<span class="keyword">new</span> VertxOptions()
    .setMetricsOptions(<span class="keyword">new</span> MicrometerMetricsOptions()
    .setEnabled(<span class="predefined-constant">true</span>)))
  .withMetrics(<span class="keyword">new</span> MicrometerMetricsFactory(myRegistry))
  .build();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_remove_influxdb_options_number_of_threads">Remove InfluxDB options number of threads</h3>
<div class="paragraph">
<p><code>VertxInfluxDbOptions#getNumThreads</code> and <code>VertxInfluxDbOptions#setNumThreads</code> are no longer used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
influxDbOptions.setNumThreads(numThreads);

<span class="comment">// 5.0</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rename_metrics_options_request_tag_provider">Rename metrics options request tag provider</h3>
<div class="paragraph">
<p><code>VertxMicrometerMetricsOptions#setRequestTagsProvider</code> and <code>VertxMicrometerMetricsOptions#getRequestTagsProvider</code> are removed in favour of <code>VertxMicrometerMetricsOptions#setServerRequestTagsProvider</code> and <code>VertxMicrometerMetricsOptions#getServerRequestTagsProvider</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
options.setRequestsTagsProvider(provider);

<span class="comment">// 5.0</span>
options.setServerRequestsTagsProvider(provider);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_dropwizard_metrics">Vert.x Dropwizard Metrics</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_http_client_pool_metrics_2">HTTP client pool metrics</h3>
<div class="paragraph">
<p>HTTP client pool metrics are now exposed as generic pool metrics with pool type <code>http</code> and named after the endpoint socket address</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>endpoint.&lt;host:port&gt;.queue-delay</code> → <code>queue-delay</code></p>
</li>
<li>
<p><code>endpoint.&lt;host:port&gt;.queue-size</code> → <code>queue-size</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_remove_setting_a_metrics_registry_on_metrics_options">Remove setting a metrics registry on metrics options</h3>
<div class="paragraph">
<p>The drop wizard options setter for a <code>MetricsRegistry</code> has been removed in favour of the new <code>VertxBuilder</code> along with the <code>DropwizardMetricsFactory</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
Vertx vertx = Vertx.vertx(<span class="keyword">new</span> VertxOptions()
 .setMetricsOptions(<span class="keyword">new</span> DropwizardMetricsOptions()
   .setMetricsRegistry(myRegistry)
   .setEnabled(<span class="predefined-constant">true</span>)));

<span class="comment">// 5.0</span>
Vertx vertx = Vertx.builder()
  .with(<span class="keyword">new</span> VertxOptions()
    .setMetricsOptions(<span class="keyword">new</span> DropwizardMetricsOptions()
    .setEnabled(<span class="predefined-constant">true</span>)))
  .withMetrics(<span class="keyword">new</span> DropwizardMetricsFactory(myRegistry))
  .build();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_json_schema">Vert.x Json Schema</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_deprecated_apis_removal">Deprecated APIs removal</h3>
<div class="paragraph">
<p>In Vert.x 5 the deprecated JSON Schema APIs are removed. Previously you had for every <em>Draft</em> an own <code>SchemaParser</code>. Now you have a <code>SchemaRepository</code> and can set the <em>Draft</em> in the options.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
JsonObject schemaJson = <span class="keyword">new</span> JsonObject(...);
<span class="predefined-type">Schema</span> schema = <span class="keyword">new</span> Draft7SchemaParser(SchemaRouter.create(vertx, <span class="keyword">new</span> SchemaRouterOptions())).parse(schemaJson , scope);
JsonObject jsonToValidate = <span class="keyword">new</span> JsonObject(...);
schema.validateSync(jsonToValidate);

<span class="comment">// 5.0</span>
JsonObject schemaJson = <span class="keyword">new</span> JsonObject(...);
SchemaRepository schemaRepo = SchemaRepository.create(<span class="keyword">new</span> JsonSchemaOptions().setDraft(DRAFT7));
JsonObject jsonToValidate = <span class="keyword">new</span> JsonObject(...);
OutputUnit result = schemaRepo.validator(JsonSchema.of(schemaJson)).validate(jsonToValidate);

<span class="keyword">if</span> (result.getValid()) {
  <span class="comment">// Successful validation</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_additional_error_types">Additional Error Types</h3>
<div class="paragraph">
<p>In Vert.x 5 extra basic error types for output units have been added.</p>
</div>
<div class="paragraph">
<p>If you are constructing your own <code>OutputUnits</code>, you will need to include the <code>OutputErrorType</code> now as well. This helps to determine the cause of the failure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// 4.x</span>
OutputUnit ou = <span class="keyword">new</span> OutputUnit(<span class="string"><span class="delimiter">&quot;</span><span class="content">instanceLocation</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">absoluteKeywordLocation</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">keywordLocation</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">error</span><span class="delimiter">&quot;</span></span>);

<span class="comment">// 5.0</span>
<span class="comment">// Available error types are current OutputErrorType.NONE, OutputErrorType.INVALID_VALID, OutputErrorType.MISSING_VALUE</span>
OutputUnit ou = <span class="keyword">new</span> OutputUnit(<span class="string"><span class="delimiter">&quot;</span><span class="content">instanceLocation</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">absoluteKeywordLocation</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">keywordLocation</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">error</span><span class="delimiter">&quot;</span></span>, OutputErrorType.INVALID_VALUE);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_removal_of_schematype_int_constant">Removal of SchemaType INT constant</h3>
<div class="paragraph">
<p>Instead, use <code>SchemaType#INTEGER</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_remove_of_validationexception_createexception_methods">Remove of ValidationException createException methods</h3>
<div class="paragraph">
<p>Instead, use the same signature <code>ValidationException#create</code> replacements.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_hazelcast">Vert.x Hazelcast</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_upgrade_to_hazelcast_5_3">Upgrade to Hazelcast 5.3</h3>
<div class="paragraph">
<p>This version includes many security fixes since Hazelcast 4.2.8.
It requires JDK 11 to run, which is now the minimum required version in Vert.x 5.</p>
</div>
<div class="paragraph">
<p>The cluster manager is also tested with Hazelcast 5.4 and Hazelcast 5.5.
But these versions require JDK 17 and JDK 21 as a minimum, respectively.
Therefore, we cannot use them by default.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-01-04 04:01:14 UTC
</div>
</div>
</body>
</html>